<group name="security_platform">
  
  <!-- Vault Authentication Events -->
  <rule id="100001" level="3">
    <decoded_as>json</decoded_as>
    <field name="type">request</field>
    <field name="auth.display_name">\.+</field>
    <description>Vault authentication success</description>
    <group>vault,authentication</group>
  </rule>

  <rule id="100002" level="8">
    <decoded_as>json</decoded_as>
    <field name="type">request</field>
    <field name="error">\.+</field>
    <match>auth</match>
    <description>Vault authentication failure</description>
    <group>vault,authentication_failed</group>
  </rule>

  <!-- Certificate Events -->
  <rule id="100010" level="5">
    <decoded_as>json</decoded_as>
    <field name="type">request</field>
    <match>pki/issue</match>
    <description>Certificate issued</description>
    <group>pki,certificate</group>
  </rule>

  <!-- Suspicious Activity -->
  <rule id="100020" level="12">
    <if_sid>100002</if_sid>
    <if_matched_sid frequency="5" timeframe="300">100002</if_matched_sid>
    <description>Multiple Vault authentication failures</description>
    <group>vault,authentication_failed,attack</group>
  </rule>

</group>